{% extends "base.html" %}

{% block title %}–ß–∞—Ç —Å –ò–ò –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º{% endblock %}

{% block content %}
  <div class="chat-header-section">
    <h1 id="taskTitle">–ß–∞—Ç —Å –ò–ò –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º</h1>
    <p class="task-info" id="taskInfo">
      {% if task %}
        –ó–∞–¥–∞—á–∞: {{ task.title }} | –°—Ä–æ–∫: {{ task.due_date.strftime('%d.%m.%Y %H:%M') if task.due_date else '' }}
      {% endif %}
    </p>
    <button class="back-to-tasks-btn" id="backToTasksBtn">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–¥–∞—á–∞–º</button>
  </div>

  <div class="chat-box" id="chatBox">
    <div class="chat-header">
      <div class="bot-avatar">ü§ñ</div>
      <div class="chat-header-text">
        <h2>–ò–ò –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</h2>
        <p id="chatStatus">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</p>
      </div>
    </div>

    <div class="messages" id="messages">
      <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
    </div>

<div class="input-area">
  <div class="input-controls">
<label for="fileInput" class="attach-button" id="attachButton" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª (.docx)">
  <!-- inline SVG –±—É–º–∞–∂–Ω–æ–π —Å–∫—Ä–µ–ø–∫–∏ (–±–æ–ª–µ–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π) -->
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
    <path d="M21 11.5v6.25a4 4 0 0 1-4 4H8.5a4 4 0 0 1-4-4v-8.75A3.75 3.75 0 0 1 8.25 4H16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M7 8.5V19a2 2 0 0 0 2 2H17" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  <input type="file" id="fileInput" accept=".docx" style="display: none;">
</label>

    <input
      type="text"
      id="messageInput"
      placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –∑–∞–¥–∞—á–µ –∏–ª–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏..."
      autocomplete="off"
      {% if not session_id %}disabled{% endif %}
      aria-label="–°–æ–æ–±—â–µ–Ω–∏–µ"
    />
    <button class="send-button" id="sendButton" {% if not session_id %}disabled{% endif %} aria-pressed="false">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
  <div class="upload-status" id="uploadStatus" style="display: none;">
    <span class="upload-text">–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞...</span>
    <div class="upload-progress">
      <div class="upload-progress-bar"></div>
    </div>
  </div>
</div>

  <!-- –ü–ª–∞–≤–∞—é—â–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π -->
  <div class="floating-unread-indicator" id="floatingUnreadIndicator">
    <span id="floatingUnreadCount">0</span> –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
    <span class="arrow">‚Üì</span>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏ (—Å–∫—Ä—ã—Ç–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) -->
  <input type="hidden" id="sessionId" value="{{ session_id }}">
  <input type="hidden" id="taskId" value="{{ task.id if task else '' }}">
{% endblock %}